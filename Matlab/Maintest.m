%Opération menant à la matrice globale
%--------------------------------------------------------------------------
clear all, close all, clc
%--------------------------------------------------------------------------
%Exprimons la valeur explicite des variables
%--------------------------------------------------------------------------
w0=1; 
k=8; 
L=2; 
T=5;
%Définir le nombre d'élément du cable
N0=2;



syms x
w(x) = w0.*(1-k*x).*exp(-k*x);

 [X0, P0] = Maillage(L, N0);

 [U0] = Cal_Sol(w,X0,T,P0);

%--------------------------------------------------------------------------
%--------------------------------------------------------------------------
% Appel de la solution Exacte
%--------------------------------------------------------------------------
%--------------------------------------------------------------------------
yEx = SolExact(x, w0, k, L, T);
%--------------------------------------------------------------------------
% Erreur absolue obtenue par collocation
%--------------------------------------------------------------------------

Err0 = ErrTotal(X0, P0, U0, yEx, 3);

%--------------------------------------------------------------------------
%Tracons le graphe
%--------------------------------------------------------------------------

for j=1:2
p0 = fplot(Err0(j),[X0(j) X0(j+1)],'m', 'Linewidth', 2);
end
hold off
grid on
legend(p0,{'Erreur EF N=100'})
title('Erreur absolue obtenue par éléments finis')
xlabel('X/L')
ylabel('(yT)/(wL^2)')
xlim([0 2])




